<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>modm: Blocking Delays</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">modm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Blocking Delays<div class="ingroups"><a class="el" href="group__modm__architecture.html">Architecture Interfaces</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Blocking Delays:</div>
<div class="dyncontent">
<div class="center"><img src="group__modm__architecture__delay.png" border="0" usemap="#group____modm____architecture____delay" alt=""/></div>
<map name="group____modm____architecture____delay" id="group____modm____architecture____delay">
<area shape="rect" href="group__modm__architecture.html" title="lbuild module: modm:architecture" alt="" coords="5,5,176,31"/>
<area shape="rect" title="lbuild module: modm:architecture:delay" alt="" coords="224,5,351,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaed3eace0f02e484c05b549e40284fb85"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__architecture__delay.html#gaed3eace0f02e484c05b549e40284fb85">MODM_DELAY_NS_IS_ACCURATE</a>&#160;&#160;&#160;bool(true or false)</td></tr>
<tr class="separator:gaed3eace0f02e484c05b549e40284fb85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga54f2f418bfd40b39a5475c1ec46f5e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__architecture__delay.html#ga54f2f418bfd40b39a5475c1ec46f5e7a">modm::delay</a> (std::chrono::nanoseconds ns)</td></tr>
<tr class="separator:ga54f2f418bfd40b39a5475c1ec46f5e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75fe0c0a7c4d50fc0e25b8e5e7a633db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__architecture__delay.html#ga75fe0c0a7c4d50fc0e25b8e5e7a633db">modm::delay_ns</a> (uint32_t ns)</td></tr>
<tr class="separator:ga75fe0c0a7c4d50fc0e25b8e5e7a633db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1b621b4537928f95a84fad677b199ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__architecture__delay.html#gac1b621b4537928f95a84fad677b199ce">modm::delay</a> (std::chrono::microseconds us)</td></tr>
<tr class="separator:gac1b621b4537928f95a84fad677b199ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4581936c87312fddf7edfa7035f888e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__architecture__delay.html#gae4581936c87312fddf7edfa7035f888e">modm::delay_us</a> (uint32_t us)</td></tr>
<tr class="separator:gae4581936c87312fddf7edfa7035f888e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8b7a30b3952ba10c8f3677ab53a7931"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__architecture__delay.html#gad8b7a30b3952ba10c8f3677ab53a7931">modm::delay</a> (std::chrono::milliseconds ms)</td></tr>
<tr class="separator:gad8b7a30b3952ba10c8f3677ab53a7931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c7344e467523431ea9af1ec092e1a71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__architecture__delay.html#ga0c7344e467523431ea9af1ec092e1a71">modm::delay_ms</a> (uint32_t ms)</td></tr>
<tr class="separator:ga0c7344e467523431ea9af1ec092e1a71"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>lbuild module: <code>modm:architecture:delay</code> </p>
<p>These functions allow you to spin for a short time using only the CPU.</p>
<p>In general it is recommended to use the <code>std::chrono</code> duration types to allow the compiler to choose the optimal implementation for you:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"> </div>
<div class="line">constexpr std::chrono::nanoseconds DELAY_TIME{100};</div>
<div class="line"><a class="code" href="group__modm__architecture__delay.html#ga54f2f418bfd40b39a5475c1ec46f5e7a">modm::delay</a>(DELAY_TIME);</div>
<div class="line"> </div>
<div class="line">constexpr std::chrono::microseconds DELAY_TIME2{200};</div>
<div class="line"><a class="code" href="group__modm__architecture__delay.html#ga54f2f418bfd40b39a5475c1ec46f5e7a">modm::delay</a>(DELAY_TIME2); <span class="comment">// same signature, different implementation</span></div>
</div><!-- fragment --><p>In your code you can also use the <code>std::chrono</code> literals:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span>std::chrono_literals;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__modm__architecture__delay.html#ga54f2f418bfd40b39a5475c1ec46f5e7a">modm::delay</a>(100ns);</div>
<div class="line"><a class="code" href="group__modm__architecture__delay.html#ga54f2f418bfd40b39a5475c1ec46f5e7a">modm::delay</a>(200us);</div>
<div class="line"><a class="code" href="group__modm__architecture__delay.html#ga54f2f418bfd40b39a5475c1ec46f5e7a">modm::delay</a>(300ms);</div>
</div><!-- fragment --><p>In order to not require wild casting around of values, there are also three overloads for (unsigned) integer values. These are particularly useful for when you do not want to or cannot use chrono literals.</p>
<div class="fragment"><div class="line"><a class="code" href="group__modm__architecture__delay.html#ga75fe0c0a7c4d50fc0e25b8e5e7a633db">modm::delay_ns</a>(100);</div>
<div class="line"><a class="code" href="group__modm__architecture__delay.html#gae4581936c87312fddf7edfa7035f888e">modm::delay_us</a>(200);</div>
<div class="line"><a class="code" href="group__modm__architecture__delay.html#ga0c7344e467523431ea9af1ec092e1a71">modm::delay_ms</a>(300);</div>
</div><!-- fragment --><p>Note that these delay functions work at any CPU clock speed, even if changed dynamically at runtime and are available very early in the startup process at hardware-init time.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Limitations</h2>
<p>The main limitations are accuracy and length of delay. The only guarantee given to you is to delay for <em>at least</em> the specified time. Note that invocation of interrupts during spinning may add delay too. For additional limitations also check the description of the <code>modm:platform:core</code> modules.</p>
<p>You should always prefer Software Timers (see <code>modm:processing:timer</code>) over these <em>blocking</em> delay functions. However, when <code><a class="el" href="namespacemodm.html#aea867c6a43c2d9ad11a0c4e2808a5f2c">modm::Clock</a></code> is not set up yet, or when you need very small delays (for example to bit-bang a protocol), you need to use these delay functions. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaed3eace0f02e484c05b549e40284fb85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed3eace0f02e484c05b549e40284fb85">&#9670;&nbsp;</a></span>MODM_DELAY_NS_IS_ACCURATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODM_DELAY_NS_IS_ACCURATE&#160;&#160;&#160;bool(true or false)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Is true if nanosecond delay is reasonably accurate. On devices with low clock speed it may not be possible to provide this function with &lt;100ns or even &lt;1000ns accuracy. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gac1b621b4537928f95a84fad677b199ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac1b621b4537928f95a84fad677b199ce">&#9670;&nbsp;</a></span>delay() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm::delay </td>
          <td>(</td>
          <td class="paramtype">std::chrono::microseconds&#160;</td>
          <td class="paramname"><em>us</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Spin for microseconds.</p>
<dl class="section warning"><dt>Warning</dt><dd>The maximum delay is less than 10 seconds.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>In debug mode this function may raise "delay.us" if input validation fails. </dd></dl>

</div>
</div>
<a id="gad8b7a30b3952ba10c8f3677ab53a7931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad8b7a30b3952ba10c8f3677ab53a7931">&#9670;&nbsp;</a></span>delay() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm::delay </td>
          <td>(</td>
          <td class="paramtype">std::chrono::milliseconds&#160;</td>
          <td class="paramname"><em>ms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Spin for milliseconds.</p>
<dl class="section warning"><dt>Warning</dt><dd>The maximum delay is less than 10 seconds.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>In debug mode this function may raise "delay.us" if input validation fails. </dd></dl>

</div>
</div>
<a id="ga54f2f418bfd40b39a5475c1ec46f5e7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga54f2f418bfd40b39a5475c1ec46f5e7a">&#9670;&nbsp;</a></span>delay() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm::delay </td>
          <td>(</td>
          <td class="paramtype">std::chrono::nanoseconds&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Spin for nanoseconds.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function is implemented as best-effort and its resolution will be very coarse especially on platforms with very slow clocks.</dd>
<dd>
The maximum delay is less than 1 millisecond.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>In debug mode this function may raise "delay.us" if input validation fails. </dd></dl>

</div>
</div>
<a id="ga0c7344e467523431ea9af1ec092e1a71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c7344e467523431ea9af1ec092e1a71">&#9670;&nbsp;</a></span>delay_ms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm::delay_ms </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ga75fe0c0a7c4d50fc0e25b8e5e7a633db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga75fe0c0a7c4d50fc0e25b8e5e7a633db">&#9670;&nbsp;</a></span>delay_ns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm::delay_ns </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="gae4581936c87312fddf7edfa7035f888e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4581936c87312fddf7edfa7035f888e">&#9670;&nbsp;</a></span>delay_us()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm::delay_us </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>us</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="agroup__modm__architecture__delay_html_gae4581936c87312fddf7edfa7035f888e"><div class="ttname"><a href="group__modm__architecture__delay.html#gae4581936c87312fddf7edfa7035f888e">modm::delay_us</a></div><div class="ttdeci">void delay_us(uint32_t us)</div></div>
<div class="ttc" id="agroup__modm__architecture__delay_html_ga54f2f418bfd40b39a5475c1ec46f5e7a"><div class="ttname"><a href="group__modm__architecture__delay.html#ga54f2f418bfd40b39a5475c1ec46f5e7a">modm::delay</a></div><div class="ttdeci">void delay(std::chrono::nanoseconds ns)</div></div>
<div class="ttc" id="agroup__modm__architecture__delay_html_ga75fe0c0a7c4d50fc0e25b8e5e7a633db"><div class="ttname"><a href="group__modm__architecture__delay.html#ga75fe0c0a7c4d50fc0e25b8e5e7a633db">modm::delay_ns</a></div><div class="ttdeci">void delay_ns(uint32_t ns)</div></div>
<div class="ttc" id="agroup__modm__architecture__delay_html_ga0c7344e467523431ea9af1ec092e1a71"><div class="ttname"><a href="group__modm__architecture__delay.html#ga0c7344e467523431ea9af1ec092e1a71">modm::delay_ms</a></div><div class="ttdeci">void delay_ms(uint32_t ms)</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
