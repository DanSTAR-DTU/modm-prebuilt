<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>modm: STM32 CMSIS Headers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">modm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">STM32 CMSIS Headers<div class="ingroups"><a class="el" href="group__modm__cmsis.html">ARM CMSIS Support</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for STM32 CMSIS Headers:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__modm__cmsis__device.png" border="0" alt="" usemap="#group____modm____cmsis____device"/>
<map name="group____modm____cmsis____device" id="group____modm____cmsis____device">
<area shape="rect" id="node1" href="group__modm__cmsis.html" title="ARM CMSIS Support" alt="" coords="5,5,153,32"/>
</map>
</td></tr></table></center>
</div>
<p>lbuild module: <code>modm:cmsis:device</code></p>
<p>This module wraps <a href="https://github.com/modm-io/cmsis-header-stm32">the CMSIS headers for STM32 devices</a> and provides the header file and CPP definitions for accessing the <code>modm:target</code> peripherals. Specifically, it copies the target header file which provides the CMSIS implementation of the target's language interface for its memory-mapped peripherals.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>"Discrepancies between documentation and headers" These CMSIS headers should reflect what's written in the documentation, however, in our experience there may be small differences in naming, behavior and availability between it and this implementation.</dd></dl>
<p>The generated header file <code><a class="el" href="device_8hpp.html">modm/platform/device.hpp</a></code> contains the necessary target define <code>STM32{FAMILY}{NAME}xx</code> or similar and includes the <code>modm:target</code>-specific header.</p>
<dl class="section note"><dt>Note</dt><dd>"Include only `modm/platform/device.hpp`!" This file is only included by interface implementations inside the <code>modm/platform</code> folder! If you need to implement your own drivers, include only this file.</dd></dl>
<h2>CMSIS Compliance</h2>
<p>modm implements the target specific CMSIS functionality itself, without using the CMSIS interface. This is necessary to provide similar functionality on non-Cortex-M based targets.</p>
<ul>
<li><code>uint32_t SystemCoreClock</code> contains an up-to-date value of CPU frequency.</li>
<li><code>void SystemCoreClockUpdate()</code> does nothing, it's a weak empty function.</li>
<li><code>void SystemInit()</code> is <b>undefined</b>: modm defines its own startup architecture, see the <code>modm:platform:core</code> module for details.</li>
</ul>
<h2>Debugging Peripherals</h2>
<p>When debugging with GDB, it can sometimes be difficult to access peripherals, due to the CMSIS implementation with CPP defines and GCC optimization flags. Depending on these circumstances, GDB may only "see" a peripheral in a certain context, which can make the debugging experience quite frustrating.</p>
<p>To aid this, we generate a linkerscript fragment and source file, which place the peripherals memory as real objects in the peripheral memory space. You can then access these peripherals inside GDB at any time, regardless of context and build profile setting:</p>
<div class="fragment"><div class="line">(gdb) p/x *GPIOB</div><div class="line">$1 = {</div><div class="line">  MODER = 0xaa0280,</div><div class="line">  OTYPER = 0x300,</div><div class="line">  OSPEEDR = 0x2a00c0,</div><div class="line">  PUPDR = 0x400100,</div><div class="line">  IDR = 0xfd0,</div><div class="line">  ODR = 0x100,</div><div class="line">  BSRR = 0x0,</div><div class="line">  LCKR = 0x0,</div><div class="line">  AFR = {0x0, 0x7744}</div><div class="line">}</div></div><!-- fragment --><p>This does not have any effect on your firmware!** It is purely a debug helper feature and none of these definitions make it into the executable.</p>
<dl class="section note"><dt>Note</dt><dd>"Beware read/write side-effects" When debugging be aware of the side-effects that your read or write to a peripheral memory location can have. It's fairly obvious that a write may have consequences, but also reads can modify peripheral state, for example, a hardware FIFO buffer may pop the queue if your read the top of it. </dd></dl>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
