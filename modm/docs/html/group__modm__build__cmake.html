<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>modm: CMake Build Script Generator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">modm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CMake Build Script Generator<div class="ingroups"><a class="el" href="group__modm__build.html">Build System Generators</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>lbuild module: <code>modm:build:cmake</code></p>
<p><a href="http://cmake.org">CMake</a> is a widely used build tool supported by almost every IDE.</p>
<p>This module generates three files:</p>
<ul>
<li>a <code>modm/repo.cmake</code> file: configures all required CMake tools with the right settings (also using information from the <code>modm:build</code> module) to compile the modm library.</li>
<li>a top-level <code>CMakeLists.txt</code>: configures CMake to build modm and your application.</li>
<li>a top-level <code>Makefile</code>: provides a convenience wrapper for calling CMake from the command line.</li>
</ul>
<p>This module is intended to be used for integration with IDEs that natively only support CMake. It therefore only provides the bare minimum of features to compile and upload your application to your target. For additional build tools features see the <code>modm:build:scons</code> module.</p>
<h2>Make Methods</h2>
<p>The <code>Makefile</code> wrapper provides these convenience methods.</p>
<h4>make cmake</h4>
<p>Generates the CMake build folders and initializes the build system.</p>
<div class="fragment"><div class="line"> $ make cmake</div><div class="line">    ...</div><div class="line">-- Configuring done</div><div class="line">-- Generating done</div><div class="line">-- Build files have been written to: build/{project.name}/cmake-build-release</div><div class="line">    ...</div><div class="line">-- Build files have been written to: build/{project.name}/cmake-build-<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a></div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>"You must call this once before you can build!" If you forget to call this first, the build will fail with this error message:</dd></dl>
<p>~~~ $ make build Error: build/cmake-build-release is not a directory make: *** [build-release] Error 1 ~~~</p>
<h4>make clean</h4>
<p>Removes the CMake build artifacts.</p>
<h4>make cleanall</h4>
<p>Removes the entire build folder. You must then first call <code>make cmake</code> before being able to build again.</p>
<h4>make build</h4>
<div class="fragment"><div class="line">make build profile={<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}</div></div><!-- fragment --><p>Compiles your application into an executable using the release or debug profile.</p>
<div class="fragment"><div class="line"> $ make build profile=release</div><div class="line">Scanning dependencies of target blink_cmake</div><div class="line">[  3%] Building C <span class="keywordtype">object</span> CMakeFiles/blink_cmake.dir/<a class="code" href="namespacemodm.html">modm</a>/ext/cmsis/device/peripherals.c.o</div><div class="line">[  7%] Building CXX <span class="keywordtype">object</span> CMakeFiles/blink_cmake.dir/<a class="code" href="namespacemodm.html">modm</a>/src/<a class="code" href="namespacemodm.html">modm</a>/architecture/driver/atomic/flag.cpp.o</div><div class="line">[ 19%] Building CXX <span class="keywordtype">object</span> CMakeFiles/blink_cmake.dir/<a class="code" href="namespacemodm.html">modm</a>/src/<a class="code" href="namespacemodm.html">modm</a>/board/board.cpp.o</div><div class="line">    ...</div><div class="line">[ 96%] Building CXX <span class="keywordtype">object</span> CMakeFiles/blink_cmake.dir/main.cpp.o</div><div class="line">[100%] Linking CXX executable blink_cmake.elf</div><div class="line">   text    data     bss     dec     <a class="code" href="group__modm__io.html#gaf61485290089e35ac0a897af1c37d4f0">hex</a> filename</div><div class="line">   1596      52   20468   22116    5664 blink_cmake.elf</div><div class="line">[100%] Built target blink_cmake.<a class="code" href="classmodm_1_1_i_o_stream.html#a2ec24a2c020997b5704df1d9ac99264c">bin</a></div><div class="line">[100%] Built target blink_cmake.<a class="code" href="classmodm_1_1_i_o_stream.html#a067f916e909f11b5c149d72a27d60b16">hex</a></div><div class="line">[100%] Built target blink_cmake.lss</div></div><!-- fragment --><h4>make size</h4>
<div class="fragment"><div class="line">make size profile={<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}</div></div><!-- fragment --><p>Displays the static Flash and RAM consumption of your target.</p>
<p>Example for the Blue Pill target:</p>
<div class="fragment"><div class="line"> $ make size</div><div class="line"></div><div class="line">Program:   1.4 KiB (2.2% used)</div><div class="line">(.build_id + .fastcode + .fastdata + .hardware_init + .rodata +</div><div class="line"> .table.copy.intern + .table.heap + .table.zero.intern + .text + .vector_rom)</div><div class="line"></div><div class="line">Data:      3.0 KiB (15.1% used) = 20 B <span class="keyword">static</span> (0.1%) + 3072 B stack (15.0%)</div><div class="line">(.bss + .fastdata + .stack)</div><div class="line"></div><div class="line">Heap:     17.0 KiB (84.9% available)</div><div class="line">(.heap1)</div></div><!-- fragment --><h4>make program</h4>
<div class="fragment"><div class="line">make program profile={<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release} [port={serial-port}]</div></div><!-- fragment --><p>Writes the executable onto your target via AvrDude or OpenOCD.</p>
<div class="fragment"><div class="line"> $ make program</div><div class="line">[100%] Built target blink_cmake</div><div class="line">[100%] Built target blink_cmake.bin</div><div class="line">[100%] Built target blink_cmake.hex</div><div class="line">[100%] Built target blink_cmake.lss</div><div class="line">Open On-Chip Debugger 0.10.0</div><div class="line">    ...</div><div class="line">Info : <span class="keyword">using</span> stlink api v2</div><div class="line">Info : Target voltage: 3.171034</div><div class="line">Info : stm32f1x.cpu: hardware has 6 breakpoints, 4 watchpoints</div><div class="line">    ...</div><div class="line">   Programming Started **</div><div class="line"><span class="keyword">auto</span> erase enabled</div><div class="line">Info : device <span class="keywordtype">id</span> = 0x20036410</div><div class="line">Info : flash size = 64kbytes</div><div class="line">    ...</div><div class="line">wrote 2048 bytes from file build/cmake-build-release/blink_cmake.elf in 0.187893s (10.644 KiB/s)</div><div class="line">   Programming Finished **</div><div class="line">   Verify Started **</div><div class="line">verified 1652 bytes in 0.104584s (15.426 KiB/s)</div><div class="line">   Verified OK **</div><div class="line">shutdown command invoked</div></div><!-- fragment --><h4>make program-bmp</h4>
<div class="fragment"><div class="line">make program-bmp profile={<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release} [port={serial-port}]</div></div><!-- fragment --><p>Writes the executable onto your target via Black Magic Probe. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>make debug</h4>
<div class="fragment"><div class="line">make <a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a> profile={<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release} ui={tui|web}</div></div><!-- fragment --><p>Launches OpenOCD in the background, then launches GDB in foreground with the correct executable with text-based or [web-based gdbgui](gdbgui) UI. When GDB exits, it stops the OpenOCD process. (* <em>only ARM Cortex-M targets</em>)</p>
<p>To use gdbgui you must have it installed via <code>pip install gdbgui</code>.</p>
<dl class="section note"><dt>Note</dt><dd>"Choose the correct profile" When debugging, make sure to select the correct compilation profile. The firmware and the executable given to GDB have to be the some or you'll see GDB translate the program counter to the wrong code locations. When you suspect a bug in your firmware, consider that it was most likely compiled with the release profile, since that's the default. First try to <code>make debug profile=release</code>, and if that doesn't help, compile and <code>make program profile=debug</code> and try <code>make debug profile=debug</code> again.</dd></dl>
<h4>make debug-coredump</h4>
<div class="fragment"><div class="line">make <a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>-coredump profile={<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release} ui={tui|web}</div></div><!-- fragment --><p>Launches GDB for post-mortem debugging with the using the data in the <code>coredump.txt</code> argument. (* <em>only ARM Cortex-M targets</em>)</p>
<p>See the <code>:platform:fault</code> module for details how to receive the coredump data.</p>
<h4>make log-itm</h4>
<div class="fragment"><div class="line">make log-itm fcpu={HCLK in <a class="code" href="group__modm__math__units.html#gafc7bd3891947ef9d6b3cc0d6b77db457">Hz</a>}</div></div><!-- fragment --><p>Configures OpenOCD in tracing mode to output ITM channel 0 on SWO pin and displays the serial output stream.</p>
<p>See the <code>:platform:itm</code> module for details how to use the ITM as a logging output.</p>
<h2>Module Options</h2>
<h3>modm:build:cmake:include_makefile: Generate a wrapper Makefile</h3>
<dl class="section warning"><dt>Warning</dt><dd>"This overwrites any top-level `Makefile` file!"</dd></dl>
<p>Generated with: <code>False in [True, False]</code> </p><h3>modm:build:cmake:include_cmakelists: Generate a CMakeLists.txt</h3>
<dl class="section warning"><dt>Warning</dt><dd>"This overwrites any top-level `CMakeLists.txt` file!"</dd></dl>
<p>Generated with: <code>False in [True, False]</code> </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
